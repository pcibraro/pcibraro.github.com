
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pablo Cibraro (Cibrax)</title>
  <meta name="author" content="Cibrax">

  
  <meta name="description" content="The configSource attribute was firstly introduced in .NET framework 2.0
to support external configuration files. This attribute can be added to any &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://cibrax.me/blog/page/21">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/cibrax" rel="alternate" title="Pablo Cibraro (Cibrax)" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44468149-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Pablo Cibraro (Cibrax)</a></h1>
  
    <h2>All about software development.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/cibrax" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:cibrax.me" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/categories">Categories</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/07/24/configsource-attribute-on-system-servicemodel-section/">ConfigSource Attribute on system.serviceModel Section</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-24T00:00:00-03:00" pubdate data-updated="true">Jul 24<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/07/24/configsource-attribute-on-system-servicemodel-section/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The configSource attribute was firstly introduced in .NET framework 2.0
to support external configuration files.</p>

<p>This attribute can be added to any configuration section to specify a an
external file for that section. Using an external configuration source
can be useful in many scenarios. For instance, you could place a section
into an external configSource if you need an easy method to swap
settings for the section depending on the environment (development,
test, or production), or  you need granular control over permissions.</p>

<p>Unfortunately, the system.serviceModel section group does not support
this attribute. If you try to add it, you will receive the following
exception:</p>

<p><strong><em>The attribute &lsquo;configSource&rsquo; cannot be specified because its name
starts with the reserved prefix &lsquo;config&rsquo; or &lsquo;lock&rsquo;</em></strong></p>

<p>What I found out is that you can use this attribute on the different
sections under system.serviceModel such as services, behaviors or
bindings.</p>

<p>For instance, the configuration file could look like this,</p>

<p>&lt;configuration></p>

<p> </p>

<p>  &lt;system.serviceModel></p>

<p>    &lt;services configSource=&ldquo;Services.config&rdquo; ></p>

<p>    &lt;/services></p>

<p> </p>

<p>    &lt;bindings configSource=&ldquo;Bindings.config&rdquo;></p>

<p>    &lt;/bindings></p>

<p> </p>

<p>    &lt;behaviors configSource=&ldquo;Behaviors.config&rdquo;></p>

<p>    &lt;/behaviors></p>

<p> </p>

<p>  &lt;/system.serviceModel></p>

<p> </p>

<p>&lt;/configuration></p>

<p> And then, each file contains the corresponding section.</p>

<p><strong>Services.config</strong></p>

<p>&lt;services></p>

<p>  &lt;service name=&ldquo;Microsoft.ServiceModel.Samples.CalculatorService&rdquo;</p>

<p>          behaviorConfiguration=&ldquo;CalculatorServiceBehavior&rdquo;></p>

<p>    &lt;host></p>

<p>      &lt;baseAddresses></p>

<p>        &lt;add
baseAddress=&ldquo;<a href="http://localhost:8000/servicemodelsamples/service">http://localhost:8000/servicemodelsamples/service</a>&rdquo;/></p>

<p>      &lt;/baseAddresses></p>

<p>    &lt;/host></p>

<p>    &lt;!&mdash; this endpoint is exposed at:
net.tcp://localhost:9000/servicemodelsamples/service  &mdash;></p>

<p>    &lt;endpoint
address=&ldquo;net.tcp://localhost:9000/servicemodelsamples/service&rdquo;</p>

<p>              binding=&ldquo;netTcpBinding&rdquo;</p>

<p>              bindingConfiguration=&ldquo;Binding1&rdquo;</p>

<p>              contract=&ldquo;Microsoft.ServiceModel.Samples.ICalculator&rdquo; /></p>

<p>    &lt;!&mdash; the mex endpoint is exposed at
<a href="http://localhost:8000/ServiceModelSamples/service/mex">http://localhost:8000/ServiceModelSamples/service/mex</a> &mdash;></p>

<p>    &lt;endpoint address=&ldquo;mex&rdquo;</p>

<p>              binding=&ldquo;mexHttpBinding&rdquo;</p>

<p>              contract=&ldquo;IMetadataExchange&rdquo; /></p>

<p>  &lt;/service></p>

<p>&lt;/services></p>

<p><strong>Bindings.config</strong></p>

<p>&lt;bindings></p>

<p>  &lt;netTcpBinding></p>

<p>    &lt;binding name=&ldquo;Binding1&rdquo;</p>

<p>            closeTimeout=&ldquo;00:01:00&rdquo;</p>

<p>            openTimeout=&ldquo;00:01:00&rdquo;</p>

<p>            receiveTimeout=&ldquo;00:10:00&rdquo;</p>

<p>            sendTimeout=&ldquo;00:01:00&rdquo;</p>

<p>            transactionFlow=&ldquo;false&rdquo;</p>

<p>            transferMode=&ldquo;Buffered&rdquo;</p>

<p>            transactionProtocol=&ldquo;OleTransactions&rdquo;</p>

<p>            hostNameComparisonMode=&ldquo;StrongWildcard&rdquo;</p>

<p>            listenBacklog=&ldquo;10&rdquo;</p>

<p>            maxBufferPoolSize=&ldquo;524288&rdquo;</p>

<p>            maxBufferSize=&ldquo;65536&rdquo;</p>

<p>            maxConnections=&ldquo;10&rdquo;</p>

<p>            maxReceivedMessageSize=&ldquo;65536&rdquo;></p>

<p>      &lt;readerQuotas maxDepth=&ldquo;32&rdquo;</p>

<p>                    maxStringContentLength=&ldquo;8192&rdquo;</p>

<p>                    maxArrayLength=&ldquo;16384&rdquo;</p>

<p>                    maxBytesPerRead=&ldquo;4096&rdquo;</p>

<p>                    maxNameTableCharCount=&ldquo;16384&rdquo; /></p>

<p>      &lt;reliableSession ordered=&ldquo;true&rdquo;</p>

<p>                      inactivityTimeout=&ldquo;00:10:00&rdquo;</p>

<p>                      enabled=&ldquo;false&rdquo; /></p>

<p>      &lt;security mode=&ldquo;Transport&rdquo;></p>

<p>        &lt;transport clientCredentialType=&ldquo;Windows&rdquo;
protectionLevel=&ldquo;EncryptAndSign&rdquo; /></p>

<p>      &lt;/security></p>

<p>    &lt;/binding></p>

<p>  &lt;/netTcpBinding></p>

<p>&lt;/bindings></p>

<p><strong>Behaviors.config</strong></p>

<p>&lt;behaviors></p>

<p>  &lt;serviceBehaviors></p>

<p>    &lt;behavior name=&ldquo;CalculatorServiceBehavior&rdquo;></p>

<p>      &lt;serviceMetadata httpGetEnabled=&ldquo;true&rdquo; /></p>

<p>      &lt;serviceDebug includeExceptionDetailInFaults=&ldquo;False&rdquo; /></p>

<p>    &lt;/behavior></p>

<p>  &lt;/serviceBehaviors></p>

<p>&lt;/behaviors></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/07/23/microsoft-sharedview-beta/">Microsoft SharedView Beta</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-23T00:00:00-03:00" pubdate data-updated="true">Jul 23<span>rd</span>, 2007</time>
        
         | <a href="/blog/2007/07/23/microsoft-sharedview-beta/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you haven&rsquo;t taken a look yet, Microsoft SharedView is a fast and easy
way to share documents and screen views with small groups of friends or
coworkers; anytime, anywhere, and what is most important, it is
completely free. This version is available up to 15 people in different
locations.</p>

<p>Although it is still in beta version, I have been using this product for
a while to show the progress of my work to other off-site teams, and it
works pretty well with a standard internet connection.</p>

<p>If you want to try it, it is
available <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=ddbf048d-db67-4c56-9335-6964e15975d2&amp;DisplayLang=en">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/07/03/wmi-support-in-wcf/">WMI Support in WCF</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-03T00:00:00-03:00" pubdate data-updated="true">Jul 3<span>rd</span>, 2007</time>
        
         | <a href="/blog/2007/07/03/wmi-support-in-wcf/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A nice thing about the management layer in WCF is the WMI support to
expose instrumentation at runtime with a well-know interface. That
instrumentation includes different service characteristics such as
contracts, services, behaviors, listeners or application hosts, which
can be accessed by different management tools.</p>

<p>The built-in provider can be activated in the configuration file of the
application through the &ldquo;wmiProviderEnabled&rdquo; attribute in the
diagnostics element, as it is shown below,</p>

<p>&lt;system.serviceModel></p>

<p>    &lt;diagnostics <strong>wmiProviderEnabled=&ldquo;true&rdquo;</strong>></p>

<p> </p>

<p>      &lt;messageLogging logEntireMessage=&ldquo;false&rdquo;
logMalformedMessages=&ldquo;false&rdquo; logMessagesAtTransportLevel=&ldquo;false&rdquo;
logMessagesAtServiceLevel=&ldquo;false&rdquo;/></p>

<p>    &lt;/diagnostics></p>

<p>    &hellip;&hellip;&hellip;..</p>

<p>&lt;/system.serviceModel></p>

<p>Of course, this can be also be done through the SvcConfigEditor tool,
which is the way I usually use for simplicity.</p>

<p>Once the WMI provider is enabled, and the service host is running, we
will able to use a tool like <a href="http://www.microsoft.com/downloads/details.aspx?familyid=6430F853-1120-48DB-8CC5-F2ABDC3ED314&amp;displaylang=en">WMI Object
Browser</a> to
see the published information.</p>

<p><img src="/images/legacy/WMI%20Object%20Browser.jpg" alt="" /></p>

<p>As is shown in the image above, if we browse to the objects in the
namespace &ldquo;root\ServiceModel&rdquo;, we will able to see an AppDomainInfo
object with information about the WCF settings, and the service
endpoints as well.</p>

<p>Also we can change some of those settings at runtime (These changes will
not be saved in the configuration), for instance, to enable message
logging, which can be ideal to detect sporadic problems on a specific
server.</p>

<p>Other settings like Performance counters can also be enabled through
this WMI model, but it requires some programming since it can not easily
done with tools like this one.</p>

<p>And finally, Powershell scripts can also be used to query information
about the objects published by the built-in WMI provider.</p>

<p>PS C:\Users\pci> get-wmiobject -class &ldquo;AppDomainInfo&rdquo; -namespace
&ldquo;root\servicemodel&rdquo; -computername &ldquo;.&rdquo;</p>

<p>__GENUS : 2\
__CLASS : AppDomainInfo\
__SUPERCLASS :\
__DYNASTY : AppDomainInfo\
__RELPATH :
AppDomainInfo.AppDomainId=2,Name=&ldquo;b576ed9b-1-128279485591533267&rdquo;,ProcessId=2184\
__PROPERTY_COUNT : 12\
__DERIVATION : {}\
__SERVER : PCI-MOBILE\
__NAMESPACE : root\servicemodel\
__PATH :
&#92;PCI-MOBILE\root\servicemodel:AppDomainInfo.AppDomainId=2,Name=&ldquo;b576ed9b-1-128279485591\
533267&rdquo;,ProcessId=2184\
AppDomainId : 2\
IsDefault : False\
LogMalformedMessages : False\
LogMessagesAtServiceLevel : False\
LogMessagesAtTransportLevel : False\
MessageLoggingTraceListeners :\
Name : b576ed9b-1-128279485591533267\
PerformanceCounters : Off\
ProcessId : 2184\
ServiceConfigPath : C:\Projects\Service WMI\service\web.config\
ServiceModelTraceListeners : {xml}\
TraceLevel : Information</p>

<p> </p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/06/18/wcf-durable-services/">WCF Durable Services</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-06-18T00:00:00-03:00" pubdate data-updated="true">Jun 18<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/06/18/wcf-durable-services/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My friend <a href="http://weblogs.asp.net/gsusx/">Jesus Rodriguez</a> has published
an excellent article about one the cool features that will be part of
WCF 3.5 (Orcas timeframe), &ldquo;Durable Services&rdquo;. If you want to know more
about this feature, take a look at his <a href="http://weblogs.asp.net/gsusx/archive/2007/06/14/orcas-durable-services.aspx">post
here</a>. </p>

<p>Enjoy!!.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/06/18/integrating-the-wcf-trace-with-the-logging-application-block/">Integrating the WCF Trace With the Logging Application Block</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-06-18T00:00:00-03:00" pubdate data-updated="true">Jun 18<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/06/18/integrating-the-wcf-trace-with-the-logging-application-block/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As part of the integration between WCF and EntLib 3.0, this last one
comes with a nice feature to redirect the WCF trace to the logging
application block. This is done by Entlib through a custom trace
listener (system.diagnostics) that captures the trace generated by WCF,
and then, transfer that trace to any of the EntLib&rsquo;s trace listeners
(Logging application block) configured in the application.</p>

<p>The image below illustrates the approach used by EntLib.</p>

<p> </p>

<p><img src="/images/legacy/Logging.gif" alt="" />\</p>

<p>The fact of executing an extra component to transfer the trace messages
and the logging application block itself will add some overhead to
the overall solution by sure. On the other hand, we can use many of the
available features in the logging application block, such as formatters,
filters and trace listeners. Regarding the trace listeners, they will
allow us to store the trace in different storages, like databases, msmq
and files to name a few. Since we can actually do the same with a custom
trace listener in system.diagnostics, the real benefit here is that we
can leverage one of listeners provided in EntLib without needing to
write one from the scratch or centralize the application trace and WCF
trace just in one place.</p>

<p>If want to still use the trace viewer tool provided in WCF
(svctraceviewer.exe), the bad news is that this tool only supports xml
files (It would be great to have a plugging architecture here to read
the trace information from any storage). Therefore, we will have to
store the trace in a valid xml format, and then build something to dump
the trace to a xml file. Entlib comes with a trace listener
XmlTraceListener that generates a xml file with the format expected by
the svctraceviewer.exe tool.\</p>

<p>The EntLib&rsquo;s trace listener to redirect the trace messages the Logging
application block can be configured as follow</p>

<p>&lt;system.diagnostics></p>

<p>        &lt;sharedListeners></p>

<p>            &lt;add name=&ldquo;EntLibListener&rdquo;
type=&ldquo;Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.EntLibLoggingProxyTraceListener,
Microsoft.Practices.EnterpriseLibrary.Logging&rdquo;/></p>

<p>        &lt;/sharedListeners></p>

<p>        &lt;sources></p>

<p>            &lt;source name=&ldquo;System.ServiceModel&rdquo;
switchValue=&ldquo;Information, ActivityTracing&rdquo; propagateActivity=&ldquo;true&rdquo;></p>

<p>                &lt;listeners></p>

<p>                    &lt;add name=&ldquo;EntLibListener&rdquo;/></p>

<p>                &lt;/listeners></p>

<p>            &lt;/source></p>

<p>        &lt;/sources></p>

<p> &lt;/system.diagnostics></p>

<p>For this post, I will demostrate how to configure the XmlTraceListener
that comes out of the box to generate the file expected by the trace
viewer tool.</p>

<p>&lt;loggingConfiguration name=&ldquo;Logging Application Block&rdquo;
tracingEnabled=&ldquo;true&rdquo;</p>

<p>    defaultCategory=&ldquo;General&rdquo; logWarningsWhenNoCategoriesMatch=&ldquo;true&rdquo;></p>

<p>    &lt;listeners></p>

<p>        &lt;add fileName=&ldquo;trace-xml.xml&rdquo;
listenerDataType=&ldquo;Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.XmlTraceListenerData,
Microsoft.Practices.EnterpriseLibrary.Logging&rdquo;</p>

<p>        traceOutputOptions=&ldquo;None&rdquo;
type=&ldquo;Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.XmlTraceListener,
Microsoft.Practices.EnterpriseLibrary.Logging&rdquo;</p>

<p>        name=&ldquo;XML Trace Listener&rdquo; /></p>

<p> </p>

<p>    &lt;/listeners></p>

<p>    &lt;formatters></p>

<p>    &lt;/formatters></p>

<p>    &lt;categorySources></p>

<p>        &lt;add switchValue=&ldquo;All&rdquo; name=&ldquo;System.ServiceModel&rdquo;></p>

<p>            &lt;listeners></p>

<p>                &lt;add name=&ldquo;XML Trace Listener&rdquo; /></p>

<p>            &lt;/listeners></p>

<p>        &lt;/add></p>

<p> </p>

<p>    &lt;/categorySources></p>

<p>    &lt;specialSources></p>

<p>        &lt;allEvents switchValue=&ldquo;All&rdquo; name=&ldquo;All Events&rdquo; /></p>

<p>        &lt;notProcessed switchValue=&ldquo;All&rdquo; name=&ldquo;Unprocessed Category&rdquo; /></p>

<p>        &lt;errors switchValue=&ldquo;All&rdquo; name=&ldquo;Logging Errors &amp; Warnings&rdquo;
/></p>

<p>    &lt;/specialSources></p>

<p> </p>

<p>&lt;/loggingConfiguration></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/06/10/asmx-wcf-migration-rest-pox-articles/">ASMX/WCF Migration - REST/POX Articles</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-06-10T00:00:00-03:00" pubdate data-updated="true">Jun 10<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/06/10/asmx-wcf-migration-rest-pox-articles/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My coleague <a href="http://weblogs.manas.com.ar/waj/">Juan Wajnerman</a> has
written two interesting articles about &#8221;<a href="http://weblogs.manas.com.ar/waj/2007/05/31/asmx-to-wcf-migration/">ASMX/WCF
Migration</a>&ldquo;
and
&rdquo;<a href="http://weblogs.manas.com.ar/waj/2007/05/13/rest-pox-client-with-wcf/">REST/POX</a>&ldquo;.
The first one describes an complete procedure to migrate a plain ASMX
web service to a WCF service using an incremental approach.</p>

<p>In the second article about &#8221;REST/POX&#8221;, he illustrates how to write a
client in WCF for a &#8221;REST/POX&#8221; service
(<a href="http://vasters.com/clemensv/PermaLink,guid,2d61b97b-3a6e-46bd-89db-b1b20499ba18.aspx">Clemens</a> made
an excellent job implementing this kind of service in WCF). REST/POX
will be fully supported in the next version of WCF (Orcas timeframe), in
the meantime, if you are interested in this topic, you can take a look
to Juan&rsquo;s article.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/05/26/clarius-consulting/">Clarius Consulting</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-05-26T00:00:00-03:00" pubdate data-updated="true">May 26<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/05/26/clarius-consulting/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>On June 4th, I will officially become an associate of <a href="http://www.clariusconsulting.net/">Clarius
Consulting</a>. I&rsquo;ll be joining a great
team of &#8221;all-stars&#8221; developers such as <a href="http://weblogs.asp.net/cazzu">Daniel
Cazzulino</a>, <a href="http://weblogs.asp.net/vga">Victor Garcia
Aprea</a>, Juan Carlos Elichirigoity and
Fernando Simonazzi, which is pretty amazing to me. Thanks guys for give
me this opportunity!!.</p>

<p>I&rsquo;m leaving Lagash after almost five years of service. As developer and
first employee of the company, I made a lot of interesting stuff
there, most of them for the Patterns &amp; Practices team. I&rsquo;d like to
thank Lagash and wish them the best in the future!</p>

<p> </p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/05/08/more-about-wcf-binding-configurations-in-sts-scenarios/">More About WCF Binding Configurations in STS Scenarios</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-05-08T00:00:00-03:00" pubdate data-updated="true">May 8<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/05/08/more-about-wcf-binding-configurations-in-sts-scenarios/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Some time ago I wrote an <a href="http://weblogs.asp.net/cibrax/archive/2006/03/14/440222.aspx">introductory
post</a>
showing a basic architecture for a federation scenario in WCF. If we go
back until then, the architecture showed there was something like the
image below:</p>

<p><img src="/images/legacy/STS_WCF_Bindings.jpg" alt="" /></p>

<p>In this simple architecture we can find the following components:</p>

<ol>
<li>Client Application: The application that will be consuming the WCF
services. In order to execute one of those services, this
application needs first a security token granted by the STS.</li>
<li>Security Token Service (STS): It is an specific service with the
unique purpose to grant tokens according to some information
received from the client. The process to grant tokens is not as easy
as it sounds, I will talk more about this later in this post.</li>
<li>Service: An specific service that provides some functionality
required by the client application, for instance, a business
operation. There is an implicit trust relationship between the
service and the STS, any valid token granted by the STS can be used
to authenticate the client.</li>
</ol>


<p>Now that we have a better understanding of the overall architecture, I
will discuss more in detail the WCF bindings involved in the process to
interchange the messages between the different parties.</p>

<h3>Communication between the client and the STS</h3>

<p>At this point, a pair of RST/RSTR messages will be interchanged between
both parties. The WCF infrastructure takes care of creating those
messages for us, but we still need to configure some channel settings
through a binding configuration. Some of those settings involve channel
security, type of transport or more specific things like the type of
security token that will be presented to the STS. </p>

<p>As you can see, there is not any limitation here and we are free to use
any of the existing WCF bindings.</p>

<p>In my previous sample I used a mutual certificate authentication over
Http. Anyway, I could also use any transport or any other kind of token
such as username token, a saml token, kerberos or any custom token.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">&lt;</span><span class="n">customBinding</span><span class="p">&gt;</span>
</span><span class='line'>  <span class="p">&lt;</span><span class="n">binding</span> <span class="n">name</span><span class="p">=</span><span class="s">&quot;MutalCertificateBinding&quot;</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="p">&lt;</span><span class="n">security</span> <span class="n">authenticationMode</span><span class="p">=</span><span class="s">&quot;MutualCertificate&quot;</span>
</span><span class='line'>         <span class="n">requireSecurityContextCancellation</span> <span class="p">=</span><span class="s">&quot;false&quot;</span>
</span><span class='line'>         <span class="n">requireSignatureConfirmation</span><span class="p">=</span><span class="s">&quot;false&quot;</span>
</span><span class='line'>         <span class="n">messageProtectionOrder</span> <span class="p">=</span><span class="s">&quot;SignBeforeEncrypt&quot;</span>
</span><span class='line'>    <span class="n">requireDerivedKeys</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="p">&lt;/</span><span class="n">security</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="p">&lt;</span><span class="n">httpTransport</span><span class="p">/&gt;</span>
</span><span class='line'>   <span class="p">&lt;/</span><span class="n">binding</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">customBinding</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Communication between the client and the service</h3>

<p>Here, we do not have the same flexibility as we had before, and
WsHttpFederation is the only available binding.</p>

<p>As it name clearly says, this binding only supports the following
aspects:</p>

<ul>
<li>Authentication based on the token obtained from the configured STS</li>
<li>Http transport, which means that we can not use other kind of
transport such as TCP, MSMQ or whatever we want.</li>
<li>Channel Security based on the token obtained from the STS.   </li>
</ul>


<h3></h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">&lt;</span><span class="n">wsFederationHttpBinding</span><span class="p">&gt;</span>
</span><span class='line'>  <span class="p">&lt;</span><span class="n">binding</span> <span class="n">name</span><span class="p">=</span><span class="s">&quot;ServiceBinding&quot;</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="p">&lt;</span><span class="n">security</span> <span class="n">mode</span><span class="p">=</span><span class="s">&quot;Message&quot;</span><span class="p">&gt;</span>
</span><span class='line'>      <span class="p">&lt;</span><span class="n">message</span> <span class="n">issuedTokenType</span><span class="p">=</span><span class="s">&quot;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1&quot;</span> <span class="n">negotiateServiceCredential</span><span class="p">=</span><span class="s">&quot;false&quot;</span><span class="p">&gt;</span>
</span><span class='line'>      <span class="p">&lt;</span><span class="n">issuer</span> <span class="n">address</span><span class="p">=</span><span class="s">&quot;http://localhost/WCFSecurityTokenService/service.svc&quot;</span> <span class="n">bindingConfiguration</span><span class="p">=</span><span class="s">&quot;MutalCertificateBinding&quot;</span> <span class="n">binding</span><span class="p">=</span><span class="s">&quot;customBinding&quot;</span><span class="p">&gt;</span>
</span><span class='line'>        <span class="p">&lt;</span><span class="n">identity</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="p">&lt;</span><span class="n">dns</span> <span class="k">value</span><span class="p">=</span><span class="s">&quot;WCFQuickstartServer&quot;</span><span class="p">/&gt;</span>
</span><span class='line'>        <span class="p">&lt;/</span><span class="n">identity</span><span class="p">&gt;</span>
</span><span class='line'>      <span class="p">&lt;/</span><span class="n">issuer</span><span class="p">&gt;</span>
</span><span class='line'>     <span class="p">&lt;/</span><span class="n">message</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="p">&lt;/</span><span class="n">security</span><span class="p">&gt;</span>
</span><span class='line'>  <span class="p">&lt;/</span><span class="n">binding</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">wsFederationHttpBinding</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other alternatives for the communication between the client and the STS</h3>

<p>A typical case could be to present a token obtained from a second STS in
our STS. This scenario is usually called Federation.</p>

<p>The image below illustrates the architecture for this kind of scenario:</p>

<p><img src="/images/legacy/Federation_WCF_Binding.jpg" alt="" /></p>

<p>What is really important about federation is that a trust relationship
can be expanded across different domains without limits through
different STS.</p>

<p>The WCF SDK already provides a good sample of this scenario, so you can
find the code here [SDK Folder]\TechnologySamples\Scenario\Federation</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/04/02/mvp-award-in-quot-connected-systems-quot/">MVP Award in &quot;Connected Systems&quot;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-04-02T00:00:00-03:00" pubdate data-updated="true">Apr 2<span>nd</span>, 2007</time>
        
         | <a href="/blog/2007/04/02/mvp-award-in-quot-connected-systems-quot/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I received an email re-awarding my &#8221;Connected Systems&#8221; MVP status
for another year. Thanks Again Microsoft !! for this award.</p>

<p>I have been quite busy this last month, working on an interesting
project for one of the 500 fortune companies and my first incursion in
the mobile arena.\
For those who do not know, I have returned to Argentina and I am working
again for my previous company <a href="http://www.lagash.com">Lagash</a>.</p>

<p>I promise I will start blogging soon so stay tuned.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/01/25/services-in-net-part-i/">Services in .NET - Part I</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-01-25T00:00:00-03:00" pubdate data-updated="true">Jan 25<span>th</span>, 2007</time>
        
         | <a href="/blog/2007/01/25/services-in-net-part-i/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>What is a service after all ?</strong></p>

<p>I could not find a concrete definition of service. Many authors give
different definitions for the same thing but all of them agree on
describing a service through the famous tenets of service orientation:</p>

<p>​1. Services are autonomous</p>

<p>​2. Service have explicit boundaries</p>

<p>​3. Services share schema and contract, but do not share implementation</p>

<p>​4. Service compatibility is determined by a policy</p>

<p>After reading these tenets I can conclude the following:</p>

<ul>
<li>Each service is independent of other services, for instance, if one
service crashes, the other services are not affected.</li>
<li>At first glance, I know where a service ends and another starts.</li>
<li>A service can be considered as an unit of design and deployment.</li>
<li>Schema describes the format and the content of the messages.
Contract describes message sequences allowed in and out of the
service. This is more related to the concept of loose-coupling
through messaging (The client and the service are decoupled), the
communication between services is performed by means of a message
interchange pattern. For instance, this is not true for a .NET
remoting object where the client must have a reference to the server
type.</li>
<li>The use of a service is governed by metadata or policies. In other
words, each service has a set of requirements to be used, and these
requirements are expresses through metadata. For instance security.</li>
</ul>


<p>This is nice in theory, but not-so-clever in practice.</p>

<p>As you can see, these tenets do not mention anything about XML, SOAP or
any of the available WS-* standards. Therefore, I assume that a Soap
Service is a concrete implementation that adhere to these principles.
Let&rsquo;s discuss more about soap service in the following paragraphs.</p>

<p><strong>Soap Services</strong></p>

<p>Soap Services interchange xml messages (Soap Messages) which basically
contains data (The payload expected by the service) and metadata
(Headers required to execute the service, most of them are part the
WS-* Family). The service policy in this kind of service is expressed
through the WS-Policy standard, and the contract through WSDL.</p>

<p>The concept of service becomes evident in WCF, where we can build real
soap services. According to the Don Box&rsquo;s article &ldquo;<a href="http://msdn.microsoft.com/msdnmag/issues/04/01/indigo/default.aspx#S3">A Guide to
Developing and Running Connected Systems with
Indigo</a>&rdquo;,  </p>

<p><em>Service-oriented development focuses on systems that are built from a
set of autonomous services. This difference has a profound impact on the
assumptions one makes about the development experience.</em></p>

<p><em>In Indigo, a service is simply a program that one interacts with via
message exchanges. A set of deployed services is a system.</em></p>

<p>In addition, a web service is an specific type of Soap Service that uses
Http as transport for interchanging messages. The Web services (Asmx)
provided by default in the .NET framework (Basic Profile 1.1)  does not
implement the concept of policy at all, unless you decided to use WSE or
WCF.</p>

<p><strong>Existing techniques to design and implement a soap service</strong></p>

<p>Once we know the business requirements for a service, it is time to
start thinking in the design and implementation. Nowadays, the most
common paths in that direction are &#8221;Development-First&#8221; and
&ldquo;Contract-First&rdquo;.</p>

<p>In the first approach or technique, which is the approach used by
default when you develop an asmx service with Visual Studio, the steps
to design the XSD and WSDL are totally hidden for the developer.</p>

<p>The developer begin authoring the service class and its operations or
methods (A asmx for simple web services or a service contract in WCF).
In addition, he decorates the service with attributes that the framework
will use later to automatically generate the WSDL for the service. In
this way, the developer does not have to deal with complexities of WSDL
or XSD and he can get the service running with some minimal efforts.  </p>

<p>On the other hand, the &ldquo;Contract-First&rdquo; approach has a completely
different starting point. As first step in this approach, the developer
usually defines the XSD types and designs the service messages.  </p>

<p>Once the service messages are ready, as second step, he begin authoring
the service WSDL or contract. Finally, the latest service&rsquo;s WSDL version
is used to generate the code and implementation.  This can be easily
done in .NET with the WSDL.exe tool, but other platforms such as JAVA
also provides tools to perform the same task. Most developers use this
approach from a client side perspective to generate the proxy classes
required to consume the service.</p>

<p>As you can imagine, creating a WSDL by hand can be a complicated and
error prone task, many developers (including me) are not familiar at all
with the complete specification. However, it provides a explicit control
of the generated contracts, which is in my opinion, it is a crucial
point for interop scenarios.</p>

<p>Unfortunately, these is not a good tooling support in Visual Studio to
use this approach, I mean VS does not provide the necessary tools
to increase the developer productivity.</p>

<p>As result, the .NET community has started developing tools to support
his approach as well. One of the most well-know projects in this are is
<a href="http://www.thinktecture.com/Resources/Software/WSContractFirst/default.html">WSCF</a>
created by <a href="http://www.thinktecture.com">Thinktecture</a>, this tool
basically provides a set of wizards and designers to generate the XSD
types and the final WSDL.</p>

<p>The <a href="http://msdn.microsoft.com/servicefactory">Service Factory Project</a>
from Patterns &amp; Practices supports both approaches as well, if you are
not familiar with project, the P&amp;P team has lately beginning to provide
software factories for different purposes, most of them are based on the
Guidance Automation Toolkit (GAT). The aim of this project is to create
web services using the best practices of the market and facilitate the
developer work through a set of tools, wizards and code generators
totally integrated in Visual Studio. Don Smith has published a [nice
blogcast](<a href="http://blogs.msdn.com/donsmith/archive/2006/04/20/579735.aspx)">http://blogs.msdn.com/donsmith/archive/2006/04/20/579735.aspx)</a>
showing the complete process to create contracts with the wizards
provided in Service Factory.</p>

<p>As usual, there is some controversy about what approach is the
best, <a href="http://www.25hoursaday.com">Dare Obasanjo</a> gives his thoughts in
this <a href="http://www.25hoursaday.com/weblog/PermaLink.aspx?guid=e1ab8978-f0a9-4913-bee3-badc1cbefbe5">interesting
post</a>.</p>

<p>I personally prefer a mix between the two approaches, which can be
illustrated with the following steps:</p>

<ol>
<li>Design the XSD types and messages</li>
<li>Create the service interface with the necessary operations</li>
<li>Decorate the interface and operations with the right attributes</li>
<li>Use the WSDL generation support provided by ASP.NET or WCF to
automatically create the service WSDL</li>
</ol>


<p>We (Me and rest of team) successfully used this approach in the <a href="http://practices.gotdotnet.com/wsibsp">&ldquo;WS-I
Sample Application&rdquo;</a> project. The
main objective here was interop between different platforms, and I can
say it worked perfect, we only found some minor issues without
importance.</p>

<p>For more information about this topic, I recommend these two articles
written by Aaron Skonnard:</p>

<ul>
<li><a href="http://msdn.microsoft.com/msdnmag/issues/05/05/ServiceStation/#S3">Contract-First Service
Development</a></li>
<li><a href="http://msdn.microsoft.com/msdnmag/issues/05/06/ServiceStation/">Techniques for Contract-First
Development</a></li>
</ul>


<p> <strong>Service Versioning</strong></p>

<p>For this section, I decided to put a link to this excellent article
<a href="http://blogs.msdn.com/donsmith/pages/VersioningWebServices.aspx">&ldquo;Versioning Web
Services&rdquo;</a>
 written by Don Smith. This article mainly discusses well-know practices
to the versioning problem in Soap Services.</p>

<p>This is all for now, I will continue discussing more topics about
service design in my next posts.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/22/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/20/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/07/23/selfhost-utilities/">SelfHost Utilities</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/23/appfabric-outputcaching/">AppFabric OutputCaching</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/31/making-ajax-calls-with-hawk-authentication-to-asp-dot-net-web-api/">Making Ajax Calls With Hawk Authentication to ASP.NET Web API</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/13/coordinating-async-work-in-node-dot-js/">Coordinating Async Work in Node.js</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/27/oauth-bridge-for-adfs-with-thinkteckture-authorization-server/">OAuth Bridge for ADFS With ThinkTecture Authorization Server</a>
      </li>
    
  </ul>
</section>
 <a href="http://feeds.feedburner.com/cibrax"><img src="http://feeds.feedburner.com/~fc/cibrax?bg=FF3300&amp;fg=000000&amp;anim=0" style="border:0" alt="" /></a>

 <script type="text/javascript" language="javascript" src="http://twittercounter.com/embed/?username=cibrax&style=white"></script>
<a href="https://mvp.microsoft.com/en-us/mvp/Pablo%20Cibraro-33800"><img src="/images/mvp.gif" border="0" /></a>
<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/pcibraro">@pcibraro</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'pcibraro',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Cibrax -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'cibrax';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
