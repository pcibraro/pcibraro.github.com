
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Conditional gets in REST - Pablo Cibraro (Cibrax)</title>
  <meta name="author" content="Cibrax">

  
  <meta name="description" content="According to the Http specification, any Http GET request should be
idempotent and safe. In this context, these principles have the
following meaning &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://cibrax.me/blog/2008/10/06/importance-of-conditional-gets-in-rest">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/cibrax" rel="alternate" title="Pablo Cibraro (Cibrax)" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44468149-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Pablo Cibraro (Cibrax)</a></h1>
  
    <h2>All about software development.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/cibrax" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:cibrax.me" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/categories">Categories</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Conditional Gets in REST</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-10-06T00:00:00-03:00" pubdate data-updated="true">Oct 6<span>th</span>, 2008</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>According to the Http specification, any Http GET request should be
idempotent and safe. In this context, these principles have the
following meaning:</p>

<p>Idempotence: One or more calls with identical requests should return the
same resource representation (As long as the resource has not changed on
the server between calls).</p>

<p>Safety:  The only action produced by a GET request is to retrieve a
resource representation, no side-effects should be evident on the
service side after executing the request. An example that violates this
principle could be a GET request that also updates some info in the
resource.</p>

<p>As long as these principles are applied correctly by a service
implementation, the client will have more available mechanisms to cache
the resource representation on its side. This has a very positive
meaning from a scalability view point, which represents a better use of
the network bandwidth and an optimization in the utilization of server
resources.</p>

<p>Those caching mechanisms are based on what is commonly called Http
conditional gets. An Http conditional get involves the use of two
special headers generated by the service, ETag and Last-Modified.</p>

<p>An Etag represents an opaque value that only the server knows how to
recreate, it could represent anything, but it is usually a hash
representing the resource version (it can be generated hashing the whole
representation content or just some parts of it, like the timestamp). On
the other hand, the Last-Modified headers represents a datetime that the
service can use to determine whether the resource has changed since the
last time it was served. The following example illustrates the
request/response messages interchanged by the client/service for a
service that returns information about customers</p>

<p>First request, the client does not have anything on the cache.</p>

<p>GET <a href="http://foo/customers/1">http://foo/customers/1</a></p>

<p>Host foo\
Accept */*\
Accept-Language en-us,en;q=0.5\
Accept-Encoding gzip,deflate\
Accept-Charset ISO-8859-1,utf-8;q=0.7,*;q=0.7\
Connection close\
Referer <a href="http://foo/">http://foo/</a>\
Pragma no-cache\
Cache-Control no-cache</p>

<p>Response:</p>

<p>Connection close\
Date Thu, 02 Oct 2008 14:46:57 GMT\
Server Microsoft-IIS/6.0\
X-Powered-By ASP.NET\
X-AspNet-Version 2.0.50727\
Content-Encoding gzip\
Content-Length 1212\
Expires Sat, 01 Nov 2008 14:46:57 GMT\
<strong>Last-Modified Mon, 29 Sep 2008 15:40:27 GMT\
Etag a9331828c517ac5d97f93b3cfdbcc9bc</strong>\
Content-Type text/xml</p>

<p>The next time the client sends a new request for the same customer, some
extra information will be included in the request headers,</p>

<p>GET <a href="http://foo/customers/1">http://foo/customers/1</a></p>

<p>Host foo\
Accept */*\
Accept-Language en-us,en;q=0.5\
Accept-Encoding gzip,deflate\
Accept-Charset ISO-8859-1,utf-8;q=0.7,*;q=0.7\
Connection close\
Referer foo\
<strong>If-Modified-Since Mon, 29 Sep 2008 15:40:27 GMT\
If-None-Match a9331828c517ac5d97f93b3cfdbcc9bc\
</strong></p>

<p>With these two new headers, the service can now determine whether it has
to serve the resource representation again or the client can use the
cached version. If the resource has not changed according to the values
in those headers (If-Modified-Since for Last-Modified and If-None-Match
for Etag), the service can return an Http status code &ldquo;304 Not
Modified&rdquo;, which instructs the client to use the cached version.</p>

<p>This approach is widely used nowadays by syndication, RSS or Atom, that
usually use the Last-Modified/If-Modified-Since to determine which items
they have to send to the client.</p>

<p>Since I am a WCF fan, I will also include here some code snippets to get
the value in those headers and return a &ldquo;304&rdquo; http status code,</p>

<p>Code to get those values:</p>

<p>if
(WebOperationContext.IncomingRequest.Headers[HttpRequestHeader.IfNoneMatch]
!= null)</p>

<p>{</p>

<p>  // Do something with etag&hellip;</p>

<p>}</p>

<p>else if
(WebOperationContext.IncomingRequest.Headers[HttpRequestHeader.IfModifiedSince]
!= null)</p>

<p>{</p>

<p>  var date =
DateTime.Parse(context.IncomingRequest.Headers[HttpRequestHeader.IfModifiedSince]);</p>

<p>}</p>

<p> </p>

<p>Code to set those values:</p>

<p> </p>

<p>WebOperationContext.OutgoingResponse.LastModified = // sets the last
modified;</p>

<p>WebOperationContext.OutgoingResponse.ETag = // sets the Etag</p>

<p>Code to return an Http 304 status code:</p>

<p>WebOperationContext.OutgoingResponse.StatusCode =
HttpStatusCode.NotModified;</p>

<p>WebOperationContext.OutgoingResponse.SuppressEntityBody = true;</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Cibrax</span></span>

      








  


<time datetime="2008-10-06T00:00:00-03:00" pubdate data-updated="true">Oct 6<span>th</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/rest/'>REST</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://cibrax.me/blog/2008/10/06/importance-of-conditional-gets-in-rest/" data-via="cibrax" data-counturl="http://cibrax.me/blog/2008/10/06/importance-of-conditional-gets-in-rest/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2008/09/12/codecamp-buenos-aires-2008/" title="Previous Post: Codecamp Buenos Aires 2008">&laquo; Codecamp Buenos Aires 2008</a>
      
      
        <a class="basic-alignment right" href="/blog/2008/10/24/rest-and-workflow-services-play-well-together/" title="Next Post: REST and Workflow services play well together">REST and Workflow services play well together &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/27/oauth-bridge-for-adfs-with-thinkteckture-authorization-server/">OAuth Bridge for ADFS With ThinkTecture Authorization Server</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/22/automatic-client-cert-detection-in-adfs-2-dot-0/">Automatic Client Cert Detection in ADFS 2.0</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/21/injecting-dynamic-content-in-windows-azure-package/">Injecting Dynamic Content in Windows Azure Packages</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/01/full-text-searches-in-sql-azure-with-solr/">Full-Text Searches in SQL Azure With Solr</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/27/unit-testing-improvements-in-asp-dot-net-web-api/">Unit Testing Improvements in ASP.NET Web API</a>
      </li>
    
  </ul>
</section>
 <a href="http://feeds.feedburner.com/cibrax"><img src="http://feeds.feedburner.com/~fc/cibrax?bg=FF3300&amp;fg=000000&amp;anim=0" style="border:0" alt="" /></a>

 <script type="text/javascript" language="javascript" src="http://twittercounter.com/embed/?username=cibrax&style=white"></script>
<a href="https://mvp.microsoft.com/en-us/mvp/Pablo%20Cibraro-33800"><img src="/images/mvp.gif" border="0" /></a>
<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/pcibraro">@pcibraro</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'pcibraro',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Cibrax -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'cibrax';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://cibrax.me/blog/2008/10/06/importance-of-conditional-gets-in-rest/';
        var disqus_url = 'http://cibrax.me/blog/2008/10/06/importance-of-conditional-gets-in-rest/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
